---
import "../styles/global.css";
import { projectData } from "../lib/getProjects";
import { Image } from "astro:assets";
import Layout from "../layouts/Layout.astro";

// const imagePrefix = "/src/projects";
// const allImages = import.meta.glob<{default: ImageMetadata}>(`/src/projects/**/**.*{jpg,jpeg,png,gif,webp}`);
// const getCoverImage = (slug: string) => {
//   const coverKey = `${imagePrefix}/${slug}/cover`;
//   const entry = Object.entries(allImages).find(([key, value]) => key.includes(coverKey));
//   if (!entry) {
//     console.error("Cover image not found for", slug);
//   }
//   return entry![1]();
// }
// console.debug("All images are", allImages);

---

<Layout>
  <ul>
    {
      projectData.map((project) => (
        <li class="mb-8">
          <a
            href={`${import.meta.env.BASE_URL}/projects/${project.slug}`}
            class="text-decoration-none text-inherit"
          >
            <div class="mb-4">
              <Image
                src={project.covers[0]()}
                alt={project.title}
                width={300}
                height={300}
              />
            </div>

            <div class="flex flex-col">
              <p class="text-lg text-gray-700">{project.title}</p>
              <p class="text-sm text-gray-700">{project.year}</p>
            </div>
          </a>
        </li>
      ))
    }
  </ul>
</Layout>
